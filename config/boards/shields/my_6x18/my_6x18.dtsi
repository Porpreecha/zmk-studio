/ {
    chosen {
        zmk,kscan = &kscan0;
    };

    // ===== WS2812 Strip =====
    led_strip: ws2812 {
        compatible = "worldsemi,ws2812-spi";
        label = "WS2812";
        reg = <0>;
        spi-max-frequency = <4000000>;
        chain-length = <108>;  /* 6x18 = 108 LEDs */
        spi-dev = <&spi1>;
        color-mapping = <LED_COLOR_MAPPING_RGB>;
        status = "okay";
    };
};

/* ===== I2C Expander MCP23017 ===== */
&i2c1 {
    status = "okay";
    clock-frequency = <100000>;

    mcp23017_a: mcp23017@20 {
        compatible = "microchip,mcp23017";
        reg = <0x20>;
        status = "okay";
    };

    mcp23017_b: mcp23017@21 {
        compatible = "microchip,mcp23017";
        reg = <0x21>;
        status = "okay";
    };
};

/* ===== Keyscan Matrix 6x18 ===== */
&kscan0 {
    compatible = "zmk,kscan-gpio-matrix";
    diode-direction = "col2row";

    row-gpios = <&mcp23017_a 0 GPIO_ACTIVE_HIGH>,
                <&mcp23017_a 1 GPIO_ACTIVE_HIGH>,
                <&mcp23017_a 2 GPIO_ACTIVE_HIGH>,
                <&mcp23017_a 3 GPIO_ACTIVE_HIGH>,
                <&mcp23017_a 4 GPIO_ACTIVE_HIGH>,
                <&mcp23017_a 5 GPIO_ACTIVE_HIGH>;

    col-gpios = <&mcp23017_b 0 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 1 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 2 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 3 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 4 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 5 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 6 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 7 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 8 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 9 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 10 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 11 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 12 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 13 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 14 GPIO_ACTIVE_HIGH>,
                <&mcp23017_b 15 GPIO_ACTIVE_HIGH>,
                <&mcp23017_a 6 GPIO_ACTIVE_HIGH>,
                <&mcp23017_a 7 GPIO_ACTIVE_HIGH>;
};
